<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Your CreditHopper dashboard - track disputes, monitor progress, and manage your credit repair journey.">
  
  <title>Dashboard - CreditHopper</title>
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/dashboard.css">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cellipse cx='50' cy='50' rx='28' ry='18' fill='%2310b981'/%3E%3Ccircle cx='75' cy='45' r='12' fill='%2310b981'/%3E%3Ccircle cx='78' cy='42' r='5' fill='white'/%3E%3Ccircle cx='79' cy='41' r='3' fill='%230d0d0f'/%3E%3Cpath d='M82 35Q88 25 92 18' stroke='%23059669' stroke-width='3' fill='none' stroke-linecap='round'/%3E%3Cpath d='M80 33Q84 20 80 12' stroke='%23059669' stroke-width='3' fill='none' stroke-linecap='round'/%3E%3Cpath d='M35 55Q18 72 12 88' stroke='%23059669' stroke-width='3' fill='none' stroke-linecap='round'/%3E%3Cpath d='M12 88Q28 84 38 78' stroke='%23059669' stroke-width='3' fill='none' stroke-linecap='round'/%3E%3Cellipse cx='45' cy='44' rx='16' ry='9' fill='%2334d399' opacity='0.5'/%3E%3C/svg%3E">

  <!-- Auth Check - Redirect if not logged in -->
  <script>
    (function() {
      const token = localStorage.getItem('ch_token');
      if (!token) {
        window.location.href = 'login.html';
      }
    })();
  </script>
</head>
<body class="dashboard-page">
  
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <a href="index.html" class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="24" cy="24" rx="13" ry="9" fill="#10b981"/>
            <circle cx="36" cy="22" r="6" fill="#10b981"/>
            <circle cx="38" cy="20" r="2.5" fill="white"/>
            <circle cx="38.5" cy="19.5" r="1.5" fill="#0d0d0f"/>
            <path d="M40 17Q43 12 45 9" stroke="#059669" stroke-width="1.5" stroke-linecap="round" fill="none"/>
            <path d="M39 16Q41 10 39 6" stroke="#059669" stroke-width="1.5" stroke-linecap="round" fill="none"/>
            <path d="M17 27Q9 35 6 42" stroke="#059669" stroke-width="1.5" stroke-linecap="round" fill="none"/>
            <path d="M6 42Q13 40 18 37" stroke="#059669" stroke-width="1.5" stroke-linecap="round" fill="none"/>
            <path d="M22 29L19 37" stroke="#059669" stroke-width="1.5" stroke-linecap="round" fill="none"/>
            <path d="M30 27L27 35" stroke="#059669" stroke-width="1.5" stroke-linecap="round" fill="none"/>
            <ellipse cx="22" cy="21" rx="8" ry="4" fill="#34d399" opacity="0.5"/>
            <rect x="14" y="22" width="13" height="2" rx="1" fill="white" opacity="0.25"/>
            <rect x="14" y="25" width="9" height="1.5" rx="0.75" fill="white" opacity="0.15"/>
          </svg>
        </div>
        <span class="logo-text">Credit<span>Hopper</span></span>
      </a>
    </div>
    
    <nav class="sidebar-nav">
      <div class="nav-section">
        <span class="nav-section-title">Main</span>
        <a href="dashboard.html" class="nav-item active">
          <i data-lucide="layout-dashboard"></i>
          <span>Dashboard</span>
        </a>
        <a href="prep-steps.html" class="nav-item">
          <i data-lucide="shield-alert"></i>
          <span>Before You Start</span>
          <span class="nav-badge" style="background: #ef4444;">!</span>
        </a>
        <a href="engine.html" class="nav-item">
          <i data-lucide="scan"></i>
          <span>Credit Engine</span>
        </a>
        <a href="#disputes" class="nav-item">
          <i data-lucide="file-text"></i>
          <span>My Disputes</span>
        </a>
        <a href="bundles.html" class="nav-item">
          <i data-lucide="folder"></i>
          <span>Letter Library</span>
        </a>
        <a href="credit-building.html" class="nav-item">
          <i data-lucide="trending-up"></i>
          <span>Credit Building</span>
        </a>
      </div>
      
      <div class="nav-section">
        <span class="nav-section-title">Account</span>
        <a href="settings.html#subscription" class="nav-item">
          <i data-lucide="credit-card"></i>
          <span>Subscription</span>
        </a>
        <a href="settings.html" class="nav-item">
          <i data-lucide="settings"></i>
          <span>Settings</span>
        </a>
        <a href="help.html" class="nav-item">
          <i data-lucide="help-circle"></i>
          <span>Help Center</span>
        </a>
      </div>
    </nav>
    
    <!-- Upgrade Card (for trial users) -->
    <div class="sidebar-upgrade" id="sidebarUpgrade" style="display: none;">
      <div class="upgrade-card">
        <div class="upgrade-icon">
          <i data-lucide="clock"></i>
        </div>
        <h4 id="upgradeTitle">Trial: -- days left</h4>
        <p id="upgradeText">Upgrade to generate letters and start disputing</p>
        <a href="checkout.html?plan=pro" class="btn btn-primary btn-sm" style="width: 100%;">Upgrade to Pro</a>
      </div>
    </div>
    
    <!-- User Menu -->
    <div class="sidebar-user">
      <div class="user-avatar" id="userAvatar">--</div>
      <div class="user-info">
        <span class="user-name" id="userName">Loading...</span>
        <span class="user-email" id="userEmail">...</span>
      </div>
      <button class="btn-icon" id="userMenuBtn" onclick="toggleUserMenu()">
        <i data-lucide="chevron-down"></i>
      </button>
      <!-- User Dropdown -->
      <div class="user-dropdown" id="userDropdown">
        <a href="settings.html" class="user-dropdown-item">
          <i data-lucide="settings"></i>
          Settings
        </a>
        <a href="help.html" class="user-dropdown-item">
          <i data-lucide="help-circle"></i>
          Help Center
        </a>
        <div class="user-dropdown-divider"></div>
        <a href="#" class="user-dropdown-item logout" onclick="handleLogout(event)">
          <i data-lucide="log-out"></i>
          Log Out
        </a>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Top Bar -->
    <header class="topbar">
      <button class="btn-icon mobile-menu-btn" id="sidebarToggle">
        <i data-lucide="menu"></i>
      </button>
      
      <div class="topbar-search">
        <i data-lucide="search"></i>
        <input type="text" placeholder="Search disputes, letters...">
      </div>
      
      <div class="topbar-actions">
        <button class="btn-icon notification-btn">
          <i data-lucide="bell"></i>
          <span class="notification-dot"></span>
        </button>
        <button class="btn btn-primary btn-sm" onclick="window.location.href='engine.html'">
          <i data-lucide="plus"></i>
          New Dispute
        </button>
      </div>
    </header>

    <!-- Dashboard Content -->
    <div class="dashboard-content">
      <!-- Important: Before You Start Alert -->
      <div class="prep-alert" id="prepAlert" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(249, 115, 22, 0.15)); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 12px; padding: 1rem 1.25rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 1rem;">
        <div style="width: 40px; height: 40px; border-radius: 10px; background: rgba(239, 68, 68, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
          <i data-lucide="shield-alert" style="width: 20px; height: 20px; color: #ef4444;"></i>
        </div>
        <div style="flex: 1;">
          <strong style="color: #fff; font-size: 0.9375rem;">Complete These Steps Before Disputing</strong>
          <p style="color: var(--dark-400); font-size: 0.8125rem; margin-top: 0.125rem;">Critical steps that protect you and maximize your success rate</p>
        </div>
        <a href="prep-steps.html" class="btn btn-sm" style="background: #ef4444; color: #fff; flex-shrink: 0;">
          View Steps
        </a>
        <button onclick="dismissPrepAlert()" class="btn-icon" style="flex-shrink: 0; width: 32px; height: 32px; background: transparent; border: none; color: var(--dark-500); cursor: pointer;">
          <i data-lucide="x" style="width: 16px; height: 16px;"></i>
        </button>
      </div>

      <!-- Welcome Section -->
      <section class="welcome-section">
        <div class="welcome-text">
          <h1 id="welcomeMessage">Welcome back! ðŸ‘‹</h1>
          <p id="welcomeSubtext">Here's what's happening with your credit repair journey.</p>
        </div>
        <div class="welcome-date">
          <i data-lucide="calendar"></i>
          <span id="currentDate"></span>
        </div>
      </section>

      <!-- Onboarding Checklist (hidden by default) -->
      <section class="onboarding-card" id="onboardingCard" style="display: none; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1)); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <div>
            <h3 style="color: #fff; font-size: 1.125rem; font-weight: 600; margin: 0;">Getting Started</h3>
            <p style="color: var(--dark-400); font-size: 0.875rem; margin: 0.25rem 0 0;">Complete these steps to begin disputing</p>
          </div>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <span id="onboardingProgress" style="color: var(--accent-400); font-weight: 600;">0%</span>
            <div style="width: 100px; height: 8px; background: var(--dark-700); border-radius: 4px; overflow: hidden;">
              <div id="onboardingProgressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #6366f1, #8b5cf6); transition: width 0.3s;"></div>
            </div>
          </div>
        </div>
        <div id="onboardingSteps" style="display: grid; gap: 0.75rem;"></div>
      </section>

      <!-- Stats Grid -->
      <section class="stats-grid" id="statsGrid">
        <div class="stat-card">
          <div class="stat-icon score">
            <i data-lucide="trash-2"></i>
          </div>
          <div class="stat-info">
            <span class="stat-value" id="statDebtEliminated">$0</span>
            <span class="stat-label">Debt Eliminated</span>
          </div>
          <div class="stat-change positive" id="statDebtChange">
            <i data-lucide="arrow-up"></i>
            <span>--</span>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon disputes">
            <i data-lucide="file-text"></i>
          </div>
          <div class="stat-info">
            <span class="stat-value" id="statItemsTotal">0</span>
            <span class="stat-label">Items on Report</span>
          </div>
          <div class="stat-change neutral" id="statItemsChange">
            <span>-- active, -- deleted</span>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon success">
            <i data-lucide="check-circle"></i>
          </div>
          <div class="stat-info">
            <span class="stat-value" id="statSuccessRate">0%</span>
            <span class="stat-label">Success Rate</span>
          </div>
          <div class="stat-change positive" id="statSuccessChange">
            <i data-lucide="arrow-up"></i>
            <span>--</span>
          </div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon letters">
            <i data-lucide="mail"></i>
          </div>
          <div class="stat-info">
            <span class="stat-value" id="statDisputesMailed">0</span>
            <span class="stat-label">Letters Sent</span>
          </div>
          <div class="stat-change neutral" id="statDisputesChange">
            <span>-- pending response</span>
          </div>
        </div>
      </section>

      <!-- Main Grid -->
      <div class="dashboard-grid">
        <!-- Active Disputes -->
        <section class="dashboard-card disputes-card">
          <div class="card-header">
            <h2>Active Disputes</h2>
            <a href="my-letters.html" class="card-link">View all <i data-lucide="arrow-right"></i></a>
          </div>
          
          <div class="disputes-list" id="disputesList">
            <!-- Empty state -->
            <div class="dispute-empty" id="disputesEmpty" style="text-align: center; padding: 2rem;">
              <i data-lucide="file-text" style="width: 48px; height: 48px; color: var(--dark-500); margin-bottom: 1rem;"></i>
              <p style="color: var(--dark-400); margin-bottom: 1rem;">No disputes yet</p>
              <a href="engine.html" class="btn btn-primary btn-sm">Start Disputing</a>
            </div>
          </div>
        </section>

        <!-- Right Column -->
        <div class="dashboard-right">
          <!-- Wins Tracker Card -->
          <section class="dashboard-card score-card">
            <div class="card-header">
              <h2>Your Wins</h2>
              <span style="font-size: 0.75rem; color: var(--accent-400); background: rgba(52, 211, 153, 0.15); padding: 0.25rem 0.75rem; border-radius: 20px;">All Time</span>
            </div>
            
            <div class="score-display">
              <div class="score-circle">
                <svg viewBox="0 0 120 120">
                  <circle cx="60" cy="60" r="54" class="score-bg"/>
                  <circle cx="60" cy="60" r="54" class="score-progress" id="winsProgress" style="--progress: 0"/>
                </svg>
                <div class="score-value">
                  <span class="score-number" id="winsTotal" style="font-size: 2.5rem;">0</span>
                  <span class="score-label">Items Removed</span>
                </div>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem;">
                <div style="background: var(--dark-800); border-radius: 12px; padding: 1rem; text-align: center;">
                  <div style="font-size: 1.5rem; font-weight: 700; color: var(--accent-400);" id="winsDebtEliminated">$0</div>
                  <div style="font-size: 0.75rem; color: var(--dark-400);">Debt Eliminated</div>
                </div>
                <div style="background: var(--dark-800); border-radius: 12px; padding: 1rem; text-align: center;">
                  <div style="font-size: 1.5rem; font-weight: 700; color: #fff;" id="winsTotalDisputed">0</div>
                  <div style="font-size: 0.75rem; color: var(--dark-400);">Total Disputed</div>
                </div>
              </div>
            </div>
            
            <div class="score-history">
              <span class="history-label">Items removed by month</span>
              <div class="history-chart" id="winsChart">
                <div class="chart-bar" style="--height: 0%"><span>0</span></div>
                <div class="chart-bar" style="--height: 0%"><span>0</span></div>
                <div class="chart-bar" style="--height: 0%"><span>0</span></div>
                <div class="chart-bar" style="--height: 0%"><span>0</span></div>
                <div class="chart-bar" style="--height: 0%"><span>0</span></div>
                <div class="chart-bar current" style="--height: 0%"><span>0</span></div>
              </div>
              <div class="chart-labels" id="winsChartLabels">
                <span>--</span>
                <span>--</span>
                <span>--</span>
                <span>--</span>
                <span>--</span>
                <span>--</span>
              </div>
            </div>
          </section>

          <!-- Quick Actions -->
          <section class="dashboard-card quick-actions-card">
            <div class="card-header">
              <h2>Quick Actions</h2>
            </div>
            
            <div class="quick-actions" id="quickActions">
              <!-- Populated dynamically -->
              <a href="engine.html" class="quick-action">
                <div class="action-icon">
                  <i data-lucide="upload"></i>
                </div>
                <span>Upload Report</span>
              </a>
              <a href="bundles.html" class="quick-action">
                <div class="action-icon">
                  <i data-lucide="file-plus"></i>
                </div>
                <span>Browse Letters</span>
              </a>
              <a href="help.html" class="quick-action">
                <div class="action-icon">
                  <i data-lucide="message-circle"></i>
                </div>
                <span>Get Help</span>
              </a>
            </div>
          </section>
        </div>
      </div>

      <!-- Recent Activity -->
      <section class="dashboard-card activity-card">
        <div class="card-header">
          <h2>Recent Activity</h2>
          <button class="btn btn-ghost btn-sm" onclick="Dashboard.loadMoreActivity()">View all</button>
        </div>
        
        <div class="activity-timeline" id="activityTimeline">
          <!-- Populated dynamically -->
          <div class="activity-item" id="activityEmpty" style="text-align: center; padding: 2rem;">
            <i data-lucide="inbox" style="width: 48px; height: 48px; color: var(--dark-500); margin-bottom: 1rem;"></i>
            <p style="color: var(--dark-400);">No activity yet. Upload a credit report to get started!</p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Mobile Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- Scripts -->
  <script src="js/main.js"></script>
  <script src="js/dashboard.js"></script>
  <script>lucide.createIcons();</script>
</body>
</html>